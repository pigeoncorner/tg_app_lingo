<div class="help-section">
    <h2>✅ Проверка грамматики</h2>
    
    <div class="help-card">
        <h3>Назначение функции</h3>
        <p>Проверка грамматики — это автоматический анализ ваших сообщений на английском языке в два прохода: на первом анализируются локальные ошибки, на втором анализируется предложение в целом. Функция находит ошибки, предлагает исправления и объясняет правила грамматики.</p>
        <div class="screenshot-placeholder">
            <img src="images/help/grammar-main.png" alt="Результат проверки грамматики">
            <p class="img-caption">Скриншот: Детальный анализ грамматики</p>
        </div>
    </div>

    <div class="help-card">
        <h3>Где доступна проверка грамматики</h3>
        <p>Функция доступна после отправки текста в таких разделах как:</p>
        <ul>
            <li><strong>Free Speech</strong> — после вашего ответа появляется кнопка "✅ Check grammar"</li>
            <li><strong>Dialog</strong> — автоматический анализ каждой вашей реплики</li>
            <li><strong>How'd native say</strong> — при вводе английской фразы</li>
            <li><strong>Build-a-Sentence</strong> — анализ предложений в упражнении</li>
        </ul>
    </div>

    <div class="help-card">
        <h3>Двухэтапная проверка</h3>
        <p>Система использует два последовательных прохода:</p>

        <div class="pass-card pass-one">
            <h4>❱❱ Первый проход</h4>
            <p><strong>Что проверяет:</strong></p>
            <ul>
                <li>Локальные грамматические ошибки</li>
                <li>Орфографические ошибки</li>
                <li>Пунктуация</li>
                <li>Порядок слов в предложении</li>
                <li>Использование предлогов</li>
            </ul>
            
            <div class="screenshot-placeholder">
                <img src="images/help/grammar-pass1.png" alt="Первый проход">
                <p class="img-caption">Скриншот: Результат первого прохода с выделенными ошибками</p>
            </div>

        </div>

        <div class="pass-card pass-two">
            <h4>❱❱ Второй проход (AI)</h4>
            <p><strong>Что проверяет:</strong></p>
            <ul>
                <li>Стилистические улучшения</li>
                <li>Использование времен в контексте</li>
                <li>Правильность предлогов</li>
                <li>Дополнительные рекомендации</li>
            </ul>

            <p><strong>Как работает:</strong></p>
            <ol>
                <li>Получает текст после первого прохода</li>
                <li>Анализирует контекст и смысл</li>
                <li>Предлагает стилистические улучшения</li>
                <li>Выдает итоговый текст</li>
            </ol>

            <div class="screenshot-placeholder">
                <img src="images/help/grammar-pass2.png" alt="Второй проход">
                <p class="img-caption">Скриншот: Результат второго прохода AI</p>
            </div>

        </div>
    </div>

    <div class="help-card">
        <h3>Версия носителя языка</h3>
        <p>После двух проходов проверки система показывает, как бы эту фразу сформулировал носитель английского языка:</p>

        <p>Это помогает увидеть разницу между грамматически правильным и естественным вариантом.</p>
    </div>

    <div class="help-card">
        <h3>Интерактивные кнопки с правилами</h3>

        <div class="screenshot-placeholder">
            <img src="images/help/grammar-buttons.png" alt="Кнопки с номерами">
            <p class="img-caption">Скриншот: Интерактивные кнопки для просмотра правил</p>
        </div>

        <p>Под сообщением с анализом отображаются кнопки с цифрами (1️⃣, 2️⃣, 3️⃣...), соответствующие найденным ошибкам:</p>

        <h4>Как пользоваться кнопками:</h4>
        <ol>
            <li>Нажмите на кнопку с номером ошибки (например, 1️⃣)</li>
            <li>Откроется подробное описание грамматического правила</li>
            <li>Кнопка пометится галочкой (✅1️⃣)</li>
            <li>Для возврата к списку ошибок нажмите кнопку "↩"</li>
        </ol>

        <div class="screenshot-placeholder">
            <img src="images/help/grammar-rule.png" alt="Описание правила">
            <p class="img-caption">Скриншот: Детальное описание грамматического правила</p>
        </div>

        <h4>Типы правил:</h4>
        <div class="rule-types">
            <div class="rule-type">
                <p><strong>С подробным описанием (1️⃣, 2️⃣, 3️⃣...):</strong></p>
                <p>Правила с подробным объяснением, примерами и рекомендациями</p>
            </div>
            <div class="rule-type">
                <p><strong>Без подробного описания (ℹ️):</strong></p>
                <p>Справочные правила без детального объяснения</p>
            </div>
        </div>

        <div class="tip-box">
            <p><strong>Совет:</strong> Изучайте правила по кнопкам — это помогает понять и запомнить грамматические конструкции.</p>
        </div>
    </div>

    <div class="help-card tips">
        <h3>Советы по использованию</h3>
        <ul>
            <li><strong>Читайте все проходы:</strong> Первый находит очевидные ошибки, второй — стилистические</li>
            <li><strong>Изучайте правила:</strong> Нажимайте на кнопки с номерами для понимания ошибок</li>
            <li><strong>Сравнивайте версии:</strong> Смотрите на различия между вашим текстом и исправленным</li>
            <li><strong>Обращайте внимание на носителя:</strong> Финальная версия показывает естественную речь</li>
            <li><strong>Используйте регулярно:</strong> Проверка помогает учиться на ошибках</li>
            <li><strong>Не игнорируйте ℹ️:</strong> Даже без подробного описания краткие пояснения полезны</li>
        </ul>
    </div>

</div>

<style>
.pass-card {
    background: var(--tg-theme-bg-color, #ffffff);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    border-left: 5px solid;
}

.pass-card.pass-one {
    border-left-color: #3b82f6;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
}

.pass-card.pass-two {
    border-left-color: #8b5cf6;
    background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
}

.pass-card h4 {
    margin: 0 0 16px 0;
    font-size: 18px;
    color: var(--tg-theme-text-color, #000000);
}

.error-example,
.ai-output {
    background: var(--tg-theme-secondary-bg-color, #f8f9fa);
    padding: 16px;
    border-radius: 8px;
    margin: 16px 0;
    border-left: 3px solid var(--tg-theme-button-color, #3390ec);
}

.error-example p,
.ai-output p {
    margin: 8px 0;
}

.improvement-categories {
    margin: 16px 0;
}

.category-item {
    background: var(--tg-theme-bg-color, #ffffff);
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 6px;
}

.category-item p {
    margin: 4px 0;
}

.category-example {
    color: var(--tg-theme-hint-color, #666666);
    font-style: italic;
    font-size: 14px;
}

.native-version {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    padding: 16px;
    border-radius: 8px;
    margin: 16px 0;
    border-left: 4px solid #f59e0b;
}

.native-text {
    font-size: 18px;
    font-weight: 600;
    margin: 8px 0 0 0;
}

.rule-types {
    margin: 16px 0;
}

.rule-type {
    background: var(--tg-theme-bg-color, #ffffff);
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 6px;
    border: 1px solid var(--tg-theme-section-separator-color, #e5e5e5);
}

.rule-type p {
    margin: 4px 0;
}

.result-structure {
    margin: 16px 0;
}

.result-section {
    background: var(--tg-theme-bg-color, #ffffff);
    padding: 16px;
    margin-bottom: 12px;
    border-radius: 8px;
    border-left: 4px solid var(--tg-theme-button-color, #3390ec);
}

.result-section h4 {
    margin: 0 0 8px 0;
    font-size: 16px;
}

.result-section .example {
    background: #f8f9fa;
    padding: 8px 12px;
    border-radius: 4px;
    margin: 8px 0;
    font-size: 14px;
}

.tip-box {
    background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
    padding: 16px;
    border-radius: 8px;
    margin: 16px 0;
    border-left: 4px solid #0ea5e9;
}

.tip-box p {
    margin: 0;
}

.faq-item {
    background: var(--tg-theme-bg-color, #ffffff);
    padding: 16px;
    border-radius: 8px;
    margin-bottom: 16px;
    border-left: 4px solid var(--tg-theme-hint-color, #999999);
}

.faq-item h4 {
    margin: 0 0 8px 0;
    font-size: 15px;
    color: var(--tg-theme-text-color, #000000);
}

.faq-item p {
    margin: 0;
    line-height: 1.6;
}

.note {
    padding: 12px;
    background: #f0f9ff;
    border-left: 3px solid #0ea5e9;
    border-radius: 4px;
    margin: 12px 0;
    font-size: 14px;
}

@media (max-width: 600px) {
    .pass-card {
        padding: 16px;
    }
}

.screenshot-placeholder {
    margin: 16px 0;
    padding: 16px;
    background: var(--tg-theme-bg-color, #ffffff);
    border: 2px dashed var(--tg-theme-section-separator-color, #e5e5e5);
    border-radius: 8px;
    text-align: center;
}

.screenshot-placeholder img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin-bottom: 8px;
}

.img-caption {
    font-size: 13px;
    color: var(--tg-theme-hint-color, #999999);
    font-style: italic;
    margin-top: 8px;
}
</style>
